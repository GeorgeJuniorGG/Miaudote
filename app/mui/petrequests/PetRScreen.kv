#:kivy 2.0
#:import get_color_from_hex kivy.utils.get_color_from_hex
#:import Color mui.ColorTheme.Color
#:set cor Color()

<PetRScreen>:
    petFav: pet_fav
    petName: pet_name
    petSex: pet_sex
    petAge: pet_age
    petAddr: pet_addr
    msgRequest: msg_request

    canvas:
        Color:
            rgba: cor.linhaBanner()
        Line:
            points: self.x, 0.9 * self.top, self.right, 0.9 * self.top
            width: 10
        Line:
            points: self.x, self.top - 10, self.right, self.top - 10
            width: 10

    MDIconButton:
        icon: "arrow-left"
        user_font_size: "35sp"
        pos_hint:{"center_x": 0.08, "center_y": 0.94}
        theme_text_color: "Custom"
        text_color: cor.detalheClaro()
        on_release:
            root.go_backward()

    MDLabel:
        text: "Miaudote"
        font_name: "Spirax-Regular"
        theme_text_color: "Custom"
        text_color: cor.rgaVermelho()
        pos_hint: {"center_y": 0.94}
        halign: "center"
        font_size: "25sp"

    MDFloatLayout:
        id: pet_bar
        orientation: "vertical"
            
        MDLabel:
            id: pet_name
            text: str(root.petName)
            theme_text_color: "Custom"
            text_color: cor.rgaVermelho()
            halign: "center"
            pos_hint: {"center_y": 0.85}
            
        MDIconButton:
            id: pet_fav
            icon: str(root.petFav)
            pos_hint: {"center_x": 0.9, "center_y": 0.85}
            theme_text_color: "Custom"
            text_color: cor.rgaVermelho()
            on_press:
                root.favourite()

        MDIconButton:
            icon: "alert-outline"
            pos_hint: {"center_x": 0.1, "center_y": 0.85}
            theme_text_color: "Custom"
            text_color: cor.rgaVermelho()
            on_press:
                root.alert()

    MDCarousel:
        size_hint: 1, 0.25
        direction: "right"
        pos_hint: {"center_x": 0.5, "center_y": 0.68}
            
        FitImage:
            source: "sorriso.png"
            
        FitImage:
            source: "mrbubbles.png"
        
    MDFloatLayout:
        size_hint: 1, 0.53

        MDLabel:
            text: "Resumo sobre " + str(root.petName)
            font_size: "20sp"
            theme_text_color: "Custom"
            text_color: cor.rgaVermelho()
            halign: "center"
            pos_hint: {"center_y": 1}

        MDLabel:
            text: "Nome: "
            theme_text_color: "Custom"
            text_color: cor.rgaVermelho()
            halign: "left"
            pos_hint: {"center_x": 0.6, "center_y": 0.9}

        MDLabel:
            id: pet_name
            text: str(root.petName)
            theme_text_color: "Custom"
            text_color: cor.textoL()
            pos_hint: {"center_x": 0.85, "center_y": 0.9}

        MDLabel:
            text: "Sexo: "
            theme_text_color: "Custom"
            text_color: cor.rgaVermelho()
            halign: "left"
            pos_hint: {"center_x": 0.6, "center_y": 0.85}
        
        MDLabel:
            id: pet_sex
            text: str(root.petSex)
            theme_text_color: "Custom"
            text_color: cor.textoL()
            halign: "left"
            pos_hint: {"center_x": 0.85, "center_y": 0.85}

        MDLabel:
            text: "Idade: "
            theme_text_color: "Custom"
            text_color: cor.rgaVermelho()
            halign: "left"
            pos_hint: {"center_x": 0.6, "center_y": 0.8}
        
        MDLabel:
            id: pet_age
            text: str(root.petAge)
            theme_text_color: "Custom"
            text_color: cor.textoL()
            halign: "left"
            pos_hint: {"center_x": 0.85, "center_y": 0.8}

        MDLabel:
            text: "Localização: "
            theme_text_color: "Custom"
            text_color: cor.rgaVermelho()
            halign: "left"
            pos_hint: {"center_x": 0.6, "center_y": 0.75}

        MDLabel:
            id: pet_addr
            text: str(root.petAddr)
            theme_text_color: "Custom"
            text_color: cor.textoL()
            halign: "left"
            pos_hint: {"center_x": 0.85, "center_y": 0.75}
    
    MDFloatLayout:
        size_hint: 1, 0.33

        MDLabel:
            text: "Status da Solicitação"
            font_size: "20sp"
            theme_text_color: "Custom"
            text_color: cor.rgaVermelho()
            halign: "center"
            pos_hint: {"center_y": 1}

        MDLabel:
            id: msg_request
            text: str(root.msgRequest)
            theme_text_color: "Custom"
            text_color: cor.textoL()
            halign: "justify"
            padding_x: 10
            pos_hint: {"center_y": 0.85}
        
        MDFillRoundFlatButton:
            text: "Abrir o Chat"
            theme_text_color: "Custom"
            text_color: cor.textoL()
            line_width: 1
            line_color: cor.textoL()
            md_bg_color: get_color_from_hex("#ffffff")
            size_hint: 0.45, 0.15
            pos_hint: {"center_x": 0.5, "center_y": 0.65}
            on_press:
                root.open_chat()

        MDFillRoundFlatButton:
            text: "Cancelar a Solicitação"
            theme_text_color: "Custom"
            text_color: cor.rgaVermelho()
            line_width: 1
            line_color: cor.textoL()
            md_bg_color: get_color_from_hex("#ffffff")
            size_hint: 0.45, 0.15
            pos_hint: {"center_x": 0.5, "center_y": 0.45}
            on_press:
                root.cancel_request()

    MDBoxLayout:
        size_hint: 1, None
        height: self.minimum_height
        y: - self.height
        orientation: "vertical"

        MDBottomNavigation:
            panel_color: cor.bottomNavPanel()
            text_color_active: get_color_from_hex(cor.bottomNavTextActive())
            text_color_normal: get_color_from_hex(cor.bottomNavTextNormal())

            canvas.after:
                Color:
                    rgba: cor.rgaBranco()
                Line:
                    points: self.x + dp(123), 65, self.x + dp(123), 0
                    width: 0.3

                Line:
                    points: self.x + dp(2*123 + 7), 65, self.x + dp(2*123 + 7), 0
                    width: 0.3

            MDBottomNavigationItem:
                text: "Menu"
                icon: "menu"

            MDBottomNavigationItem:
                text: "Início"
                icon: "home"

            MDBottomNavigationItem:
                text: "Perfil"
                icon: "account-circle"